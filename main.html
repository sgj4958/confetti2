<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì—°ìŠµì¥</title>
  <style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    .body {
        border: 1px solid #ddd;
        margin: 5px;
        overflow: hidden;
        width: 90vw;
        height: 90vh;
        display: flex;
        justify-content: center;
        align-items: center;

        .wrap {
            position: relative;
            width: 100px;
            height: 40px;
            border: 1px solid #ddd;
            background: #fff;
            border-radius: 5px;

            button {
                width: 100%;
                height: 100%;
                border: none;
                background: none;
                display: flex;
                justify-content: center;
                align-items: center;
                padding: 0 10px;
                cursor: pointer;
            
                p {
                    transform-origin: 0 100%;
                    width: 100%;
                    &:nth-child(1) {width: 20px;}
                }
            }
            
            canvas {
                width: 200%;
                position: absolute;
                bottom: 0;
                left: 0;
            }
        }
    }

  </style>
</head>
<body>
    <div class="body">

        <div class="wrap">
            <button><p>ğŸ‰</p><p>Confetti2</p></button>
            <canvas></canvas>
        </div>

    </div>
</body>
<script>
    const í­ì£½ = (elementQuery, option = {}) => {
        option = {
            ìˆ˜ëŸ‰: 50,
            í¬ê¸°: [5, 15],
            xì†ë„: [1, 4],
            yì†ë„: [-5, -10],
            xìœ„ì¹˜: 20,
            yìœ„ì¹˜: 20,
            ...option
        }

        const ëœë¤ = (...ê°’) => Math.random() * (Math.max(...ê°’) - Math.min(...ê°’)) + Math.min(...ê°’)
        const parent = document.querySelector(elementQuery)

        const canvas = document.querySelector("canvas")
        const ctx = canvas.getContext("2d")
        canvas.height = canvas.width

        const í­ì£½ = (particles) => {
            const g = 0.1 // ì¤‘ë ¥ê°€ì†ë„
            const e = 0.001 // ë°˜ë°œê³„ìˆ˜
            const u = 0.02 // ë§ˆì°°ê³„ìˆ˜

            parent.querySelector("button p").style.transform = "skew(10deg, 10deg)"
            setTimeout(() => parent.querySelector("button p").style.transform = "none", 100)
            let af

            const ë°œì‚¬ = () => {
                ctx.clearRect(0, 0, canvas.width, canvas.height)
                particles.forEach((el, i, a) => {
                    ctx.fillStyle = el.ìƒ‰ìƒ

                    el.vx -= u
                    el.x += el.vx

                    el.vy += g
                    el.y += el.vy
                    if(el.y > canvas.height - el.í¬ê¸°) return a.splice(i, 1)
                    else if(el.y < 0) {
                        el.y = 0
                        el.vy *= -e
                    }

                    ctx.save()
                    ctx.translate(el.x, el.y)
                    ctx.rotate(Math.PI * el.íšŒì „++ / 180)
                    ctx.fillRect(-el.í¬ê¸° / 2, -el.í¬ê¸° / 2, el.í¬ê¸°, el.í¬ê¸°)
                    ctx.restore()
                })

                af = requestAnimationFrame(ë°œì‚¬)
                if(!particles.length) cancelAnimationFrame(af)
            }
            ë°œì‚¬()
        }

        const ìƒì„± = () => {
            í­ì£½(new Array(option.ìˆ˜ëŸ‰).fill().map(() => {
                return {
                    x: option.xìœ„ì¹˜ + ëœë¤(-3, 3),
                    y: canvas.height - option.yìœ„ì¹˜ + ëœë¤(-1, 1),
                    vx: ëœë¤(...option.xì†ë„),
                    vy: ëœë¤(...option.yì†ë„),
                    í¬ê¸°: ëœë¤(...option.í¬ê¸°),
                    ìƒ‰ìƒ: `hsl(${Math.round(Math.random() * 360)} 98% 82% / 1)`,
                    íšŒì „: ëœë¤(0, 360)
                }
            }))
        }

        parent.querySelector(".wrap").addEventListener("click", ìƒì„±)
    }

    í­ì£½(".body")
</script>
</html>